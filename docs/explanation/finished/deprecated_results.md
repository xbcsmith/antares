# Deprecated Usage Results (#[allow(deprecated)]) — SDK and Game Engine

This document enumerates occurrences of `#[allow(deprecated)]` usage across the SDK and Game Engine.
Each entry includes a file path, a short code snippet showing the usage, a suggested migration action, and a recommended priority for remediation.

Notes:

- The `#[allow(deprecated)]` attribute suppresses deprecation warnings at the call site — often used in tests/templates that utilize legacy fields (e.g., `alignment_restriction`, `disablements`) or deprecated APIs from dependencies. This table should inform triage and migration planning.
- Suggested changes are prioritized as High/Medium/Low. “High” means likely to affect runtime or domain behavior; “Medium” is for templates, tests with broad coverage; “Low” is for example/test-only code that has lower immediate impact.

---

| File path                                                            | Code snippet (context)                                                                                                                                               | Suggested change                                                                                                                                                | Priority |
| -------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- |
| `sdk/campaign_builder/src/asset_manager.rs`                          | `// Create an item with a matching name pattern`<br>`use antares::domain::types::DiceRoll;`<br>`#[allow(deprecated)]`<br>`let item = Item { id: 1 as ItemId, ... };` | Replace test fixture item creation to use the current `Item` model; remove `alignment_restriction`/other deprecated fields; update tests to use the new fields. | Medium   |
| `sdk/campaign_builder/src/advanced_validation.rs`                    | `#[allow(deprecated)]`<br>`fn create_test_item(id: u32, value: u32) -> Item { Item { ... } }`                                                                        | Change helper to use new classification/proficiency fields; ensure test coverage for the new model; remove `#[allow(deprecated)]`.                              | Medium   |
| `sdk/campaign_builder/src/items_editor.rs`                           | `#[allow(deprecated)]`<br>`pub fn default_item() -> Item { Item { id: 0, name: "New Item".to_string(), ... } }`                                                      | Update default item to use required proficiency/classification fields; update UI code if it references deprecated fields.                                       | High     |
| `sdk/campaign_builder/src/items_editor.rs`                           | `#[allow(deprecated)]`<br>`fn show_list(&mut self, ...) { ... }`                                                                                                     | Update list UI data/fixtures; ensure left column and inspector use new item fields; confirm filters rely on new attributes.                                     | High     |
| `sdk/campaign_builder/src/items_editor.rs`                           | `#[test] #[allow(deprecated)]`<br>`fn test_item_type_filter_matches_weapon() { ... }`                                                                                | Convert tests to new data shape; update expectations; remove `#[allow(deprecated)]` once migrated.                                                              | Medium   |
| `sdk/campaign_builder/src/items_editor.rs`                           | `#[test] #[allow(deprecated)]`<br>`fn test_item_type_filter_matches_armor() { ... }`                                                                                 | Convert test fixtures to new fields; update test assertions accordingly.                                                                                        | Medium   |
| `sdk/campaign_builder/src/items_editor.rs`                           | `#[test] #[allow(deprecated)]`<br>`fn test_item_type_filter_matches_quest() { ... }`                                                                                 | Convert test fixtures to new fields; update test assertions accordingly.                                                                                        | Medium   |
| `sdk/campaign_builder/src/undo_redo.rs`                              | `#[allow(deprecated)]`<br>`fn create_test_item(id: u32, name: &str) -> Item { Item { ... } }`                                                                        | Replace older-field creation with the new item model; update tests that rely on old fields.                                                                     | Medium   |
| `sdk/campaign_builder/src/templates.rs`                              | `#[allow(deprecated)]`<br>`pub fn create_item(&self, template_id: &str, id: u32) -> Option<Item> { ... }`                                                            | Update template builder to produce Items with new classification/proficiency fields; update any RON template shapes and tests.                                  | Medium   |
| `sdk/campaign_builder/src/templates.rs` (tests)                      | `#[test] #[allow(deprecated)] fn test_custom_templates() { ... }`                                                                                                    | Update tests to new template outputs; remove `#[allow(deprecated)]`.                                                                                            | Medium   |
| `sdk/campaign_builder/src/main.rs`                                   | `#[allow(deprecated)]`<br>`fn default_item() -> Item { ... }`                                                                                                        | Update default item creation helper in the app to the new model; adjust UI and expectations accordingly.                                                        | High     |
| `sdk/campaign_builder/src/main.rs` (tests)                           | `#[test] #[allow(deprecated)]`<br>`fn test_item_type_filter_all_types() { ... }`                                                                                     | Update tests to use new model; remove `#[allow(deprecated)]`.                                                                                                   | Medium   |
| `sdk/campaign_builder/src/main.rs` (tests)                           | `#[test] #[allow(deprecated)]`<br>`fn test_item_import_export_roundtrip() { ... }`                                                                                   | Update import/export tests with the new RON structure; ensure backward-compatibility tests are separated & documented.                                          | High     |
| `sdk/campaign_builder/src/main.rs` (tests)                           | `#[test] #[allow(deprecated)]`<br>`fn test_item_type_specific_editors() { ... }`                                                                                     | Update per-editor tests to the new model; replace deprecated checks.                                                                                            | High     |
| `sdk/campaign_builder/src/main.rs` (tests)                           | `#[test] #[allow(deprecated)]`<br>`fn test_combined_filters() { ... }`                                                                                               | Update test to use the new item attributes for filtering; remove suppressions.                                                                                  | Medium   |
| `sdk/campaign_builder/src/main.rs` (tests)                           | `#[test] #[allow(deprecated)]`<br>`fn test_item_preview_displays_all_info() { ... }`                                                                                 | Update preview tests to ensure inspector uses new item fields.                                                                                                  | Medium   |
| `sdk/campaign_builder/src/advanced_validation.rs` (duplicate)        | (See above: helper `create_test_item` uses deprecated fields)                                                                                                        | Same as above; remove reliance on deprecated fields in tests.                                                                                                   | Medium   |
| `src/bin/item_editor.rs`                                             | `#[allow(deprecated)] let item = Item { id, ... };`                                                                                                                  | Update CLI `add_item()` and any UI layers that rely on old fields to the new system; update CLI tests; remove suppression.                                      | High     |
| `src/bin/item_editor.rs` (tests)                                     | `#[test] #[allow(deprecated)] fn test_next_item_id_with_items() { ... }`                                                                                             | Update tests to rely on new model and data.                                                                                                                     | Medium   |
| `src/bin/item_editor.rs` (tests)                                     | `#[test] #[allow(deprecated)] fn test_item_with_alignment_restriction() { ... }`                                                                                     | Replace `alignment_restriction` with `required_proficiency`/classification tests and update expectations accordingly.                                           | High     |
| `src/bin/item_editor.rs` (tests)                                     | `#[test] #[allow(deprecated)] fn test_item_with_tags() { ... }`                                                                                                      | Update the tests to use new tags/classification fields or dedicated helpers.                                                                                    | Medium   |
| `src/domain/items/types.rs`                                          | `#[test] #[allow(deprecated)] fn test_cursed_item_display() { ... }`                                                                                                 | Domain tests should be ported to verify new behavior; update test builders and domain validation.                                                               | High     |
| `src/domain/items/types.rs` (tests with `#[allow(deprecated)]`)      | `#[allow(deprecated)] let symbol = Item { id: 44, name: "Holy Symbol", item_type: ItemType::Accessory(...) ... };`                                                   | Replace with new classification/proficiency fields and ensure expected behaviors are consistent.                                                                | High     |
| `src/domain/items/types.rs` (tests)                                  | `#[allow(deprecated)] let ring = Item { ... }`                                                                                                                       | Replace with new model; adjust tests as needed.                                                                                                                 | High     |
| `src/domain/items/types.rs` (tests)                                  | `#[allow(deprecated)] let arrows = Item { ... }`                                                                                                                     | Replace with new model and verify ammo behavior tests.                                                                                                          | Medium   |
| `src/sdk/templates.rs`                                               | `#[allow(deprecated)] pub fn basic_weapon(...) -> Item` and many similar template helper functions                                                                   | Update template helpers to not populate deprecated fields; adjust template outputs.                                                                             | Medium   |
| `tests/cli_editor_tests.rs`                                          | `#[allow(deprecated)]` in several item creation lines (e.g., `alignment_restriction: None,`)                                                                         | Update cli tests to new model fields; maintain legacy behavior in separate tests if required.                                                                   | Medium   |
| `sdk/campaign_builder/src/asset_manager.rs` (duplicate)              | (See asset_manager snippet above.)                                                                                                                                   | See asset_manager plan.                                                                                                                                         | Medium   |
| `sdk/campaign_builder/src/undo_redo.rs` (duplicate)                  | (See undo_redo helper snippet above.)                                                                                                                                | See undo/redo plan.                                                                                                                                             | Medium   |
| `sdk/campaign_builder/src/items_editor.rs` (tests duplicate entries) | Several tests in the file are annotated with `#[allow(deprecated)]` — e.g., filters tests and preview tests                                                          | Fix tests, create updated item fixtures, and remove `#[allow(deprecated)]`.                                                                                     | Medium   |

---

## Observations & Global Refactor Plan (Summary)

- The majority of `#[allow(deprecated)]` occurrences are in test/build fixture code that constructs Items via legacy fields such as `alignment_restriction` and `disablement`.
- Real-time code and UI may also rely on helper default `Item` constructors that should be updated to produce the new shape.
- Suggested migration approach:
  1. Migrate domain types & tests at priority (High).
  2. Migrate runtime-critical editor/UI/CLI helpers & tests (High).
  3. Migrate templates & template tests (Medium).
  4. Remove `#[allow(deprecated)]` annotations and clean up degenerate code/test coverage.
  5. Add explicit legacy compatibility tests if needed and tag them clearly for future removal.
- Where specific fields are deprecated (e.g., `alignment_restriction` replaced by `required_proficiency`):
  - Replace usage in tests & templates with the new fields.
  - Replace runtime UI filtering with proficiency/class validation logic.
  - Update domain validation tests accordingly.

---

## Next steps (if desired)

1. If you would like, I can produce a CSV export with all the exact instances and line numbers for tracking.
2. I can create a "migration checklist" PR for the High priority files to start the migration.
3. I can make a separate set of PRs across SDK and Game Engine for the changes proposed above.

---

If you want the CSV/line number style table or a prioritized PR plan for High-priority items, say so and I’ll prepare it next.
